!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FryanGoauth=t():e.FryanGoauth=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{FryanGoauth:()=>s,default:()=>a});var n,i=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class r{constructor(e){this.gapi=void 0,this.then=e=>(r["#LIFECYCLE"].success=e,this),this.catch=e=>(r["#LIFECYCLE"].error=e,this),this.afterGapiMounted=e=>(r["#LIFECYCLE"].afterGapiMounted=e,this),this.afterGapiClientMounted=e=>(r["#LIFECYCLE"].afterGapiClientMounted=e,this),this.oAuthSignedIn=e=>(r["#LIFECYCLE"].oAuthSignedIn=e,this),this.oAuthSignedOut=e=>(r["#LIFECYCLE"].oAuthSignedOut=e,this),this.afterOAuthSigned=e=>(r["#LIFECYCLE"].afterOAuthSigned=e,this),this.auth=function(){const e=this;return{get isSignedIn(){const{gapi:t}=e;let n=!1;try{n=t.auth2.getAuthInstance().isSignedIn.get()}catch(e){console.log("[isSignedIn] - Unready init")}return n},signin(){const{gapi:t}=e;if(this.isSignedIn)return Promise.reject("Already signed in");try{const e=t.auth2.getAuthInstance().signIn();return Promise.resolve(e)}catch(e){return Promise.reject(e)}},signout(){const{gapi:t}=e;if(!this.isSignedIn)return Promise.reject("Already signed out");try{const e=t.auth2.getAuthInstance().signOut();return Promise.resolve(e)}catch(e){return Promise.reject(e)}},get getUserProfile(){const{gapi:t}=e;if(!this.isSignedIn)return Promise.reject(!1);try{const e=t.auth2.getAuthInstance().currentUser.get().getBasicProfile();return Promise.resolve({id:e.getId(),name:e.getName(),giveName:e.getGivenName(),familyName:e.getFamilyName(),image:e.getImageUrl(),email:e.getEmail()})}catch(e){return Promise.reject("[getUserProfile] - Error when get user profile")}}}}.bind(this)(),n.set(this,(function(){return new Promise((e,t)=>i(this,void 0,void 0,(function*(){const n=this;(yield function(){return i(this,void 0,void 0,(function*(){return"https:"===window.location.protocol||(window.location.href="https:"+window.location.href.substring(window.location.protocol.length),!1)}))}())||t("Not https");var o;(yield(o=r["#GAPI"],new Promise((e,t)=>{const n=document.createElement("script");n.type="text/javascript";try{n.onload=function(n){void 0!==window.gapi?e(!0):t(!1)},n.onerror=()=>{t(!1)},n.src=o,document.getElementsByTagName("head")[0].appendChild(n)}catch(e){t(!1)}})).then(()=>(r["#LIFECYCLE"].afterGapiMounted(window.gapi),this.gapi=window.gapi,!0)).catch(()=>!1))||t("Gapi is not loaded");(yield function(){return i(this,void 0,void 0,(function*(){const{gapi:e}=n;return yield new Promise((t,n)=>{e.load("client",()=>{e&&e.client?t(!0):n(!1)})}).then(()=>(r["#LIFECYCLE"].afterGapiClientMounted(n.gapi.client),!0)).catch(()=>!1)}))}())||t("Error when loading client from gapi ");(yield(()=>i(this,void 0,void 0,(function*(){return yield new Promise((e,t)=>{const i=this.gapi.client,o=r["#GOAUTH_CONFIG"];i.init({apiKey:o.apiKey,clientId:o.clientID,scope:o.scopes.join(" "),discoveryDocs:o.discoveryDocs}).then(()=>{const{auth2:t}=n.gapi,i=function(e){if(e){const e=t.getAuthInstance().currentUser.get().getBasicProfile(),n=e.getEmail(),i=e.getId();r["#LIFECYCLE"].oAuthSignedIn({guid:i,gmail:n})}else r["#LIFECYCLE"].oAuthSignedOut();r["#LIFECYCLE"].afterOAuthSigned(e)};t.getAuthInstance().isSignedIn.listen(e=>{i(e)}),Promise.resolve(t.getAuthInstance()).then(()=>{const n=t.getAuthInstance().isSignedIn.get();i(n),n||t.getAuthInstance().signIn(),e(!0)})}).catch(e=>{t("An error occurred when loading gapi.client.oAuth")})})})))())||t("Error when loading gapi.client.auth"),e(!0)})))})),r["#GAPI"]=""+e.gapiPath,r["#GOAUTH_CONFIG"].apiKey=e.oAuthConfig.apiKey,r["#GOAUTH_CONFIG"].clientID=e.oAuthConfig.clientID,r["#GOAUTH_CONFIG"].discoveryDocs=e.oAuthConfig.discoveryDocs,r["#GOAUTH_CONFIG"].scopes=e.oAuthConfig.scopes,o(this,n,"f").call(this).then(()=>{r["#LIFECYCLE"].success()}).catch(e=>{r["#LIFECYCLE"].error(e)})}}n=new WeakMap,r["#LIFECYCLE"]={afterGapiMounted:e=>{},afterGapiClientMounted:e=>{},oAuthSignedIn:e=>{},oAuthSignedOut:()=>{},afterOAuthSigned:e=>{},success:()=>{},error:e=>{}},r["#GOAUTH_CONFIG"]={apiKey:"",clientID:"",discoveryDocs:[],scopes:[]};const s=r,a=s;return t})()}));
//# sourceMappingURL=fryan.goauth.min.js.map