(()=>{"use strict";var t,e=function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{a(n.next(t))}catch(t){r(t)}}function c(t){try{a(n.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,c)}a((n=n.apply(t,e||[])).next())}))},i=function(t,e,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(t):n?n.value:e.get(t)};class n{constructor(o){this.gapi=void 0,this.then=t=>(n["#LIFECYCLE"].success=t,this),this.catch=t=>(n["#LIFECYCLE"].error=t,this),this.afterGapiMounted=t=>(n["#LIFECYCLE"].afterGapiMounted=t,this),this.afterGapiClientMounted=t=>(n["#LIFECYCLE"].afterGapiClientMounted=t,this),this.oAuthSignedIn=t=>(n["#LIFECYCLE"].oAuthSignedIn=t,this),this.oAuthSignedOut=t=>(n["#LIFECYCLE"].oAuthSignedOut=t,this),this.afterOAuthSigned=t=>(n["#LIFECYCLE"].afterOAuthSigned=t,this),this.auth=function(){const t=this;return{get isSignedIn(){const{gapi:e}=t;let i=!1;try{i=e.auth2.getAuthInstance().isSignedIn.get()}catch(t){console.log("[isSignedIn] - Unready init")}return i},signin(){const{gapi:e}=t;if(this.isSignedIn)return Promise.reject("Already signed in");try{const t=e.auth2.getAuthInstance().signIn();return Promise.resolve(t)}catch(t){return Promise.reject(t)}},signout(){const{gapi:e}=t;if(!this.isSignedIn)return Promise.reject("Already signed out");try{const t=e.auth2.getAuthInstance().signOut();return Promise.resolve(t)}catch(t){return Promise.reject(t)}},get getUserProfile(){const{gapi:e}=t;if(!this.isSignedIn)return Promise.reject(!1);try{const t=e.auth2.getAuthInstance().currentUser.get().getBasicProfile();return Promise.resolve({id:t.getId(),name:t.getName(),giveName:t.getGivenName(),familyName:t.getFamilyName(),image:t.getImageUrl(),email:t.getEmail()})}catch(t){return Promise.reject("[getUserProfile] - Error when get user profile")}}}}.bind(this)(),t.set(this,(function(){return new Promise((t,i)=>e(this,void 0,void 0,(function*(){const o=this;(yield function(){return e(this,void 0,void 0,(function*(){return"https:"===window.location.protocol||(window.location.href="https:"+window.location.href.substring(window.location.protocol.length),!1)}))}())||i("Not https");var r;(yield(r=n["#GAPI"],new Promise((t,e)=>{const i=document.createElement("script");i.type="text/javascript";try{i.onload=function(i){void 0!==window.gapi?t(!0):e(!1)},i.onerror=()=>{e(!1)},i.src=r,document.getElementsByTagName("head")[0].appendChild(i)}catch(t){e(!1)}})).then(()=>(n["#LIFECYCLE"].afterGapiMounted(window.gapi),this.gapi=window.gapi,!0)).catch(()=>!1))||i("Gapi is not loaded");(yield function(){return e(this,void 0,void 0,(function*(){const{gapi:t}=o;return yield new Promise((e,i)=>{t.load("client",()=>{t&&t.client?e(!0):i(!1)})}).then(()=>(n["#LIFECYCLE"].afterGapiClientMounted(o.gapi.client),!0)).catch(()=>!1)}))}())||i("Error when loading client from gapi ");(yield(()=>e(this,void 0,void 0,(function*(){return yield new Promise((t,e)=>{const i=this.gapi.client,r=n["#GOAUTH_CONFIG"];i.init({apiKey:r.apiKey,clientId:r.clientID,scope:r.scopes.join(" "),discoveryDocs:r.discoveryDocs}).then(()=>{const{auth2:e}=o.gapi,i=function(t){if(t){const t=e.getAuthInstance().currentUser.get().getBasicProfile(),i=t.getEmail(),o=t.getId();n["#LIFECYCLE"].oAuthSignedIn({guid:o,gmail:i})}else n["#LIFECYCLE"].oAuthSignedOut();n["#LIFECYCLE"].afterOAuthSigned(t)};e.getAuthInstance().isSignedIn.listen(t=>{i(t)}),Promise.resolve(e.getAuthInstance()).then(()=>{const n=e.getAuthInstance().isSignedIn.get();i(n),n||e.getAuthInstance().signIn(),t(!0)})}).catch(t=>{e("An error occurred when loading gapi.client.oAuth")})})})))())||i("Error when loading gapi.client.auth"),t(!0)})))})),n["#GAPI"]=""+o.gapiPath,n["#GOAUTH_CONFIG"].apiKey=o.oAuthConfig.apiKey,n["#GOAUTH_CONFIG"].clientID=o.oAuthConfig.clientID,n["#GOAUTH_CONFIG"].discoveryDocs=o.oAuthConfig.discoveryDocs,n["#GOAUTH_CONFIG"].scopes=o.oAuthConfig.scopes,i(this,t,"f").call(this).then(()=>{n["#LIFECYCLE"].success()}).catch(t=>{n["#LIFECYCLE"].error(t)})}}t=new WeakMap,n["#LIFECYCLE"]={afterGapiMounted:t=>{},afterGapiClientMounted:t=>{},oAuthSignedIn:t=>{},oAuthSignedOut:()=>{},afterOAuthSigned:t=>{},success:()=>{},error:t=>{}},n["#GOAUTH_CONFIG"]={apiKey:"",clientID:"",discoveryDocs:[],scopes:[]};const o=n;window.FryanGoauth=o})();
//# sourceMappingURL=fryan.goauth.min.js.map